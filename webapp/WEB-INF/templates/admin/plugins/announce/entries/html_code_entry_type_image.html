<#include "/admin/plugins/announce/commons.html" />
<@formGroup id='form${entry.idEntry}' labelFor='attribute_${entry.idEntry}' labelKey='${entry.title}' mandatory=entry.mandatory htmlRequired=false>
	<@inputGroup>
		<#if list_responses?? && list_responses?has_content>
				<#if list_responses?size &gt; 1 >
					<#assign class = 'pirobox_gall'>
				<#else>
					<#assign class = 'pirobox'>
				</#if>
				<#assign hasImage = false >
				<#list list_responses as response>
					<#if response.file?? && response.file.idFile &gt; 0>
						<#assign hasImage = true >
						<#break>
					</#if>
				</#list>
				<#if hasImage>
					<@ul id='slideshow'>
						<#list list_responses as response>
							<#if response.file?? && response.file.idFile &gt; 0>
								<@li>
									<@link href='image?resource_type=announce_img&id=${response.idResponse}' title='#i18n{announce.view_announce.imagesCaption}'>
										<@img class='thumbnail' url='image?resource_type=announce_img&id=${response.idResponse}' title='${response.toStringValueResponse!}' />
									</@link>
								</@li>
							</#if>
						</#list>
					</@ul>
					<br><br><br><br><br>
				</#if>
			</#if>
			<#assign field = getFieldValueByCode( entry, "file_config" )>
			<#if list_responses??>
				<#list list_responses as response>
					<#if response.entry.idEntry == entry.idEntry && response.entry.error??>
						<#assign classValue='error'>
					</#if>
				</#list>
				<#assign classValue='form-control ${entry.CSSClass!}'>
			</#if>
			<@input type='file' name='attribute_${entry.idEntry}' id='attribute_${entry.idEntry}' size='${field.width}' class=classValue />
			<@input type='hidden' name='_announce_upload_maxLength_attribute_${entry.idEntry}' id='_announce_upload_maxLength_attribute_${entry.idEntry}' value='${getFileMaxSize( entry )}' />
			<#if entry.helpMessage?exists&&entry.helpMessage!=''>
				<@formHelp>${entry.helpMessage}</@formHelp>
			</#if>
			<#if list_responses?? && list_responses?has_content>
				<#assign response_error = list_responses[0]>
				<#if response_error.entry.idEntry == entry.idEntry && response_error.entry.error??>
					<@alert color='danger'>
						<#assign error = response_error.entry.error>
						<#if error.mandatoryError>
							#i18n{announce.message.mandatory.entry}
						<#else>
							${error.errorMessage}
						</#if>
					</@alert>
				</#if>
			</#if>
			<@button class='btn btn-primary btn-xs btn-flat' type='submit' id='_announce_upload_submit_attribute_${entry.idEntry}' name='_announce_upload_submit_attribute_${entry.idEntry}' title='#i18n{announce.action.send.name}' />
	</@inputGroup>
</@formGroup>

<#-- file removing -->
<#assign has_files = false>
<#if list_responses?? && list_responses?has_content>
	<#assign response_error = list_responses[0]>
	<#if response_error.entry.idEntry == entry.idEntry>
		<#assign has_files = true>
	</#if>
</#if>

<#if !has_files>
	<@formGroup labelFor='delete_${entry.idEntry}' labelKey='#i18n{announce.file.uploadedFile}' mandatory=entry.mandatory params='style="display:none;"' >
		<#assign file_index = 0>
		<#if has_files>
			<#list list_responses as response>
				<#if response.file?? && response.file.title?? && response.file.title != ''>
					<@checkBox orientation='switch' labelFor='_announce_upload_checkbox_attribute_${entry.idEntry}${file_index}' labelKey='${response.file.title}' name='_announce_upload_checkbox_attribute_${entry.idEntry}${file_index}' id='mandatory' value='1' params='onchange="javascript:changeVisilityAnonymizePattern();"' />
					<#assign file_index = file_index + 1>
				</#if>
			</#list>
		</#if>
		<@inputGroup>
			<@button class='btn btn-primary btn-xs btn-flat' name='_announce_upload_delete_attribute_${entry.idEntry}' type='submit' >#i18n{announce.action.delete.name}</@button>
		</@inputGroup>		
	</@formGroup>
</#if>
